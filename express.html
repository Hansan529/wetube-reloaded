<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style.css" />
    <title>Express</title>
  </head>
  <body>
    <h1>#3.1 ~ 3.2 GET Requests</h1>
    <p>
      ì„œë²„ì— ì ‘ì†í•˜ë©´ <span class="codeline">Cannot GET /</span>ë¼ëŠ” í…ìŠ¤íŠ¸ê°€
      ë³´ì¸ë‹¤. ì´ëŠ” ë¸Œë¼ìš°ì €ê°€ ì„œë²„ì—ê²Œ GET (http mathod) requestsë¥¼ ë³´ë‚´ê³  ìˆëŠ”
      ê²ƒì´ë‹¤.
    </p>
    <p>ì´ ìš”ì²­ì„ ë°˜ì‘í•˜ê¸° ìœ„í•´ì„œ</p>
    <pre class="codeBlock">
      const app = express();
      <span class="comment">// ì„œë²„ ìƒì„± ì´í›„</span>

      app.<span class="attribute">get</span>(<span class="text"><span class="text">"/"</span></span>, () =&gt; <span class="console">console</span>.log(<span class="text">"somebody is trying to go home."</span>)

      <span class="comment">// ì™¸ë¶€ ì ‘ì†ì„ listen í•˜ê¸° ì „</span>
      <span class="const">const</span> handleListening = () =&gt;
        <span class="console">console</span>.log(<span class="text"
        >`Server listening on port http://localhost:</span
      >${PORT} ğŸš€`); 
      
      app.listen(<span class="console">PORT</span>, handleListening);
    </pre>
    <p>
      ë¨¼ì € app.<span class="attribute">get</span>ìœ¼ë¡œ
      <span class="text">"/"</span>ë¥¼ request ë°›ìœ¼ë©´ console.logë¥¼ ë°˜ì‘í•˜ê²Œ
      ë§Œë“¤ì—ˆë‹¤.
    </p>
    <p>
      ì„œë²„ì— ì ‘ì†í•œ í›„, ìƒˆë¡œê³ ì¹¨ì„ í•´ë³´ë©´ í˜ì´ì§€ê°€ ê³„ì† ë¡œë”©ë˜ë©´ì„œ í˜ì´ì§€ë¥¼ ë¶ˆëŸ¬
      ì˜¬ ìˆ˜ ì—†ì„ ê²ƒì´ë‹¤.
    </p>
    <p>
      ë‹¤ë¥¸ ì£¼ì†Œë¥¼ ì…ë ¥í•  ê²½ìš° &lt;http://localhost:4000/abcdefg&gt; ëŒ€ê¸° ì‹œê°„
      ì—†ì´ ë°”ë¡œë°”ë¡œ í˜ì´ì§€ê°€ ë¡œë”©ë˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
    </p>
    <p>
      / í˜ì´ì§€(home)ì— ì ‘ì†í•˜ë©´ ì„œë²„ì—ì„œëŠ” console.logì˜ ë‚´ìš©ì„ ì¶œë ¥í•œ ê²ƒì„ í™•ì¸
      í•  ìˆ˜ ìˆë‹¤.
    </p>
    <span class="codeline">somebody is tring to go home.</span>
    <span
      >í™ˆí˜ì´ì§€ë¥¼ ë³´ë©´ ê³„ì†í•´ì„œ ë¡œë”©í•œë‹¤. í•˜ì§€ë§Œ ì²˜ë¦¬ëŠ” ì§„í–‰í–ˆê³  ì‘ë‹µì„ ì•ˆí•˜ê³ 
      ìˆëŠ” ê²ƒì´ë‹¤.</span
    >

    <br />

    <h1>#3.3 Responses</h1>

    <pre class="codeBlock">
      <span class="const">const</span> handleHome = (req, res) =&gt; <span class="console">console</span>.log(<span class="text">"somebody is trying to go home."</span>); 
      
      app.<span class="attribute">get</span>(<span class="text"><span class="text">"/"</span></span>, handleHome);
    </pre>
    <p>
      EventListenerì—ê² eventê°€ ìˆê³ , expressì—ì„  2ê°œì˜ objectê°€ ìˆë‹¤. request
      object, responses object
    </p>
    <p>
      req, res ì´ë¦„ ëŒ€ì‹  ë‹¤ë¥¸ ì´ë¦„ì„ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ
      <strong>í•„ìˆ˜ë¡œ 2ê°€ì§€ë¥¼ ëª¨ë‘ ì‘ì„±í•´ì£¼ì–´ì•¼ í•œë‹¤.</strong> req í•˜ë‚˜ë§Œ
      ì‘ì„±í•œë‹¤ê±°ë‚˜, res í•˜ë‚˜ë§Œ ì‘ì„±í•˜ë©´ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.
    </p>
    <p>
      &lt;&quot;req&quot;&gt; &nbsp;&nbsp; &lt;&quot;res&quot;&gt; í˜•ì‹ì´ë‹¤.
    </p>
    <p>
      reqë¥¼ console.logë¥¼ í•´ë³¸ë‹¤ë©´ https://localhost:4000/ í˜ì´ì§€ë¥¼ request
      í•´ë³¸ë‹¤ë©´ ë§¤ìš° ë§ì€ ê°’ë“¤ì„ ì½˜ì†”ì—ì„œ í™•ì¸ í•  ìˆ˜ ìˆë‹¤
    </p>
    <pre class="codeBlock">
      <span class="comment">// express ìƒëµ</span>

      <span class="const">const</span> handleHome = (req, res) =&gt; <span class="console">console</span>.log(req); 
      
      app.<span class="attribute">get</span>(<span class="text"><span class="text">"/"</span></span>, handleHome);
    </pre>

    <p>í•´ë‹¹ ê²°ê³¼ê°’ë“¤ì´ request objectì´ë‹¤.</p>

    <p>
      ë¸Œë¼ìš°ì €ê°€ ìš”ì²­í•˜ëŠ” ê²ƒì´ê³ , ì¿ í‚¤ë‚˜ GET, method ë“±ë“± ì—¬ëŸ¬ ì •ë³´ë“¤ì„ ì–»ì„ ìˆ˜
      ìˆë‹¤.
    </p>
    <pre class="codeBlock">
      <span class="comment">// ìƒëµ</span>

      <span class="const">const</span> handleHome = (req, res) =&gt; <span class="console">console</span>.log(res);
    </pre>

    <p>
      ë¸Œë¼ìš°ì €ê°€ requestë¥¼ ë³´ë‚´ë©´ ìš°ë¦¬ëŠ” ì‘ë‹µì„ í•´ì£¼ì–´ì•¼ í•˜ê¸°ì—
      <span class="const">return</span>ì„ ì‚¬ìš©í•œë‹¤.
    </p>

    <pre class="codeBlock">
      <span class="const">const</span> handleHome = (req, res) =&gt; {
        <span class="const">return</span> res.end(); 
      };
    </pre>

    <p>
      ë‹¤ì‹œ ì„œë²„ë¥¼ ì‹¤í–‰í•˜ê³ , localhostì— requestë¥¼ ìš”ì²­í•˜ë©´, ë¸Œë¼ìš°ì €ê°€ ë¡œë”©ë˜ë˜
      ì´ì „ê³¼ëŠ” ë‹¤ë¥´ê²Œ return í•˜ì—¬ í˜ì´ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ê²Œëœë‹¤.
    </p>
    <p>í•´ë‹¹ í•¨ìˆ˜ê°€ responsesë¥¼ ì¢…ë£Œí•˜ì—¬ ì„œë²„ê°€ requestë¥¼ ëë‚´ë²„ë¦° ê²ƒì´ë‹¤</p>

    <p>ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œë„ requestë¥¼ ì¢…ë£Œì‹œí‚¬ ìˆ˜ ìˆë‹¤.</p>
    <p>
      <span class="codeline"><span class="const">return</span> res.send()</span>
      ì´ë ‡ê²Œ 2ê°€ì§€ê°€ ìˆë‹¤.
    </p>

    <h1>#3.5 Middlewares</h1>

    <p>
      MiddlewareëŠ” requestì™€ response ì‚¬ì´ì— ìˆë‹¤. ëª¨ë“  í•¨ìˆ˜(handle)ëŠ”
      controllerê°€ ë  ìˆ˜ë„ mideelewareê°€ ë ìˆ˜ìˆë‹¤.
    </p>

    <pre class="codeBlock">
      <span class="const">import</span> express <span class="const">from</span> <span class="quot">"express"</span>;

      <span class="const">const</span> <span class="tag">PORT</span> = 4000;

      <span class="const">const</span> <span class="tag">app</span> = <span class="attribute">express</span>();

      <span class="const">const</span> controllerHome = (req, res) =&gt; {
        <span class="const">return</span> res.<span class="attribute">end</span>("<span class="tag">&lt;h1&gt;</span>HTML h1<span class="tag">&lt;/h1&gt;</span>");
      }; 
      <span class="const">const</span> controllerLogin = (req, res) =&gt; {
        <span class="const">return</span> res.<span class="attribute">send</span>({ message: <span class="text">"Login here"</span> }
        ); 
      }; 
      
      app.<span class="attribute">get</span>(<span class="text"><span class="text">"/"</span></span>, controllerHome); 
      app.<span class="attribute">get</span>(<span class="text">"/login"</span>, controllerLogin);

      <span class="const">const</span> <span class="tag">controllerListening</span> = () =&gt; <span class="console">console</span>.log(<span class="text"
        >Server listening on port http://localhost:</span
      >${PORT} ğŸš€`); 
      
      app.<span class="attribute">listen</span>(<span class="console">PORT</span>, controllerListening);
    </pre>

    <p>
      reqì™€ res ë§ê³ ë„ í•œ ê°€ì§€ ìš”ì†Œê°€ ë” ìˆë‹¤. (req, res,
      <span class="codeline">next</span>) nextë¼ëŠ” ê²ƒì´ ìˆë‹¤. ë‹¤ìŒì„ ë¶ˆëŸ¬ì˜¤ëŠ”
      í•¨ìˆ˜ì¸ë°
    </p>

    <pre class="codeBlock">
      <span class="const">const</span> <span class="tag">controllerHome</span> = (req, res, next) =&gt; {
        <span class="attribute">next</span>();
      };
    </pre>

    <p>
      ì´ì™€ ê°™ì´ ë³€ê²½í•˜ê³  ë©”ì¸ ë£¨íŠ¸ë¡œ ì´ë™í•´ë³´ë©´ "Cannot GET /" ë¼ëŠ” í…ìŠ¤íŠ¸ë§Œ
      ë¡œë”©ëœë‹¤.
    </p>
    <p>ì™œëƒí•˜ë‚˜ë©´ ë‹¤ìŒ í•¨ìˆ˜ê°€ ì—†ê¸° ë•Œë¬¸ì— ë¶ˆëŸ¬ ì˜¬ ìˆ˜ ì—†ëŠ” ê²ƒì´ë‹¤.</p>

    <pre class="codeBlock">
      <span class="const">const</span> <span class="tag">gossipMiddleware</span> = (req, res, next) =&gt; { 
        <span class="console">console</span>.log(<span class="text">"I'm in the middle"</span>);
        <span class="attribute">next</span>();
      }; 
      <span class="const">const</span> <span class="tag">controllerHome</span> = (req, res, next) =&gt; { 
        <span class="const">return</span> res.<span class="attribute">end</span>(); 
      };

      app.<span class="attribute">get</span>(<span class="text"><span class="text">"/"</span></span>, gossipMiddleware, controllerHome);
    </pre>

    <p>
      ì„œë²„ í„°ë¯¸ë„ì— "I'm in the middle" ì´ë¼ëŠ” í…ìŠ¤íŠ¸ì™€ next í•¨ìˆ˜ë¡œ
      controllerHome í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•´ returnì„ í•œ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.
    </p>
    <p>
      gossipMiddleware í•¨ìˆ˜ê°€ middlewareê°€ ë˜ê³ , controllerHome í•¨ìˆ˜ê°€ returnì„
      í•˜ê¸° ë•Œë¬¸ì— finalwareê°€ ëœë‹¤.
    </p>

    <pre class="codeBlock">
      <span class="const">const</span> <span class="tag">gossipMiddleware</span> = (req, res, next) =&gt; { 
        <span class="console">console</span>.log(`Someone is going to:${req.url}`); 
        <span class="attribute">next</span>();
      };
    </pre>

    <p>console: <span class="codeline">Someone is going to: /</span></p>

    <p>
      requestì˜ ì •ë³´ë¥¼ ê°€ì§€ê³  ì „ë‹¬í•´ì£¼ëŠ” ê²ƒì´ë¼ middlewareì—ì„œ req.url ê°’ì„
      í˜¸ì¶œí•´ë³´ë©´ ê°’ì„ ìœ ì§€í•˜ê³  ìˆëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
    </p>

    <p>
      <span class="codeline">gossipMiddleware</span>ëŠ” í˜„ì¬
      <span class="text"><span class="text">"/"</span></span> URLì—ì„œë§Œ
      ë°˜ì‘í•˜ëŠ”ë°, ì–´ëŠ URLì—ë„ ì‘ë™í•˜ë„ë¡ ë§Œë“¤ì–´ ì£¼ëŠ” ê²Œ
      <span class="codeline">.use</span> methodì´ë‹¤.
    </p>

    <pre class="codeBlock">
      <span class="comment">// use ìˆœì„œëŠ” get ë³´ë‹¤ ë¨¼ì € ë¶ˆëŸ¬ì™€ì•¼ í•œë‹¤.</span>
      app.<span class="attribute">use</span>(gossipMiddleware);

      <span class="comment">// controllerHome =&gt; handleHome</span>
      app.<span class="attribute">get</span>(<span class="text">"/"</span>, handleHome);
    </pre>

    <p>
      ë‹¤ë¥¸ ê²½ë¡œë¡œ reqë¥¼ ë³´ë‚´ë³´ë©´ cannot GET /@@@@ ê°€ í‘œì‹œë˜ì§€ë§Œ í„°ë¯¸ë„ì—ëŠ” í•´ë‹¹
      ê²½ë¡œê°’ì„ ë³¼ ìˆ˜ ìˆë‹¤.
    </p>

    <p>í•˜ì§€ë§Œ ì´ ìˆœì„œë¥¼ ë°˜ëŒ€ë¡œ ì§€ì •í•˜ë©´ ì½˜ì†”ì—ëŠ” ì•„ë¬´ëŸ° ì •ë³´ë„ ì—†ë‹¤.</p>

    <pre class="codeBlock">
      app.<span class="attribute">get</span>(<span class="text">"/"</span>, handleHome); 
      app.<span class="attribute">use</span>(gossipMiddleware);
    </pre>

    <p>
      requestê°€ ìš”ì²­ë˜ì–´ handleHomeì„ ì‹¤í–‰í•˜ê³ , ê·¸ í›„ì— gossipMiddlewareë¥¼
      ì‹¤í–‰í•˜ë„ë¡ expressëŠ” ì§€ì •ì„ í–ˆëŠ”ë°,
    </p>

    <p>
      handleHomeì—ì„œ requestë¥¼ ì¢…ë£Œì‹œì¼°ê¸°ì— gossipMiddlewareê°€ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”
      ê²ƒì´ë‹¤. + <span class="codeline">req.method</span>ë¥¼ í˜¸ì¶œí•˜ë©´ ì–´ë–¤
      methodë¡œ í˜¸ì¶œ í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤. ê¸°ë³¸ìœ¼ë¡œëŠ”
      <span class="codeline">GET</span>ì´ë‹¤.
    </p>

    <pre class="codeBlock">
      <span class="comment">// gossipMiddleware</span>
      <span class="const">const</span> <span class="tag">logger</span> = (req, res, next) =&gt; {
        <span class="console">console</span>.log(`${req.method} ${req.url}`);
        <span class="attribute">next</span>();
      };

      <span class="comment">// ìƒˆë¡œìš´ middleware</span>
      <span class="const">const</span> <span class="tag">privateMiddleware</span> = (req, res, next) =&gt; { 
        <span class="const">const</span> <span class="tag">url</span> = req.<span class="attribute">url</span>; 
        if (<span class="tag">url</span> === <span class="quot">"/protected"</span>) { 
          <span class="const">return</span> res.<span class="attribute">send</span>(<span class="tag">"&lt;h1&gt;</span>Not Allowed<span class="tag">&lt;/h1&gt;</span>"); 
          } 
        <span class="attribute">next</span>();
      };

      app.<span class="attribute">use</span>(<span class="tag">logger</span>, privateMiddleware);
      app.<span class="attribute">get</span>(<span class="text"><span class="text">"/"</span></span>, handleHome);
    </pre>

    <p>
      ì–´ë– í•œ ê²½ë¡œë¥¼ ìš”ì²­í•˜ë˜ì§€ loggerì™€ privateMiddleware í•¨ìˆ˜ëŠ” ì‹¤í–‰ë˜ë„ë¡
      í•˜ê³ , ë§Œì•½ ìš”ì²­í•œ ê²½ë¡œê°€ protectedì¼ ê²½ìš° Not Allowedë¥¼ htmlì— ì¶œë ¥í•˜ê³ ,
      ì•„ë‹ ê²½ìš°ì—ëŠ” nextë¡œ ë„˜ê¸´ë‹¤.
    </p>

    <h1># ì •ë³´, Recap</h1>

    <p>
      .getì€ functionì´ í•„ìš”í•˜ë‹¤. <span class="codeline">1+1</span>,
      <span class="codeline">console.log("hi")</span>ì™€ ê°™ì€ ê²ƒì€ ë°”ë¡œ ì‹¤í–‰í•˜ê¸°
      ë•Œë¬¸ì— ì—ëŸ¬ê°€ ë°œìƒí•˜ê³ , ì´ ì—ëŸ¬ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ”
    </p>

    <p>
      ë³„ë„ì˜ functionì„ ìƒì„±í•´ì„œ ë¶ˆëŸ¬ì˜¤ê±°ë‚˜,
      <span class="codeline">app.get("", () =&gt; console.log("hi"))</span>ì™€
      ê°™ì´ inline functionì„ ì§€ì •í•´ì£¼ì–´ì•¼ ì—ëŸ¬ê°€ ì‚¬ë¼ì§„ë‹¤.
    </p>

    <pre class="codeBlock">
      <span class="comment"
        >// ìœ ì§€ë³´ìˆ˜ ì°¨ì›ìœ¼ë¡œ ë³„ë„ì˜ functionì„ ìƒì„±í•´ì„œ ì§€ì •í•˜ëŠ”ê²Œ ì¢‹ë‹¤.</span
      >

      <span class="comment">// function</span>
      <span class="const">const</span> <span class="tag">handleHome</span> = (req, res) =&gt; { 
        res.<span class="attribute">send</span>(<span class="text">"hello"</span>); 
      };

      <span>app.<span class="attribute">get</span>(<span class="text"><span class="text">"/"</span></span>, handleHome);</span>

      <span class="comment">// inline</span>
      app.<span class="attribute">get</span>(<span class="text"><span class="text">"/"</span></span>, (<span class="tag">req</span>, <span class="tag">res</span>) =&gt; res.send("hello"));
    </pre>

    <p>
      <span class="codeline">handler</span>ì˜ ê²½ìš° ì´ë¦„ì€ req, resë¡œ ì§€ì • í• 
      í•„ìš” ì—†ë‹¤. ë‹¨ì§€ ì½”ë“œë¥¼ ë´¤ì„ ë•Œ ì¸ì§€í•˜ê¸° ì‰½ë„ë¡ í•œ ê²ƒì´ë‹¤.
    </p>

    <pre class="codeBlock">
      <span class="comment">// ê¸°ì¡´ ì½”ë“œ</span>
      <span class="const">const</span> <span class="tag">handleHome</span> = (req, res) =&gt; {
        <span class="const">return</span> res.<span class="attribute">send</span>("<span class="tag">&lt;h1&gt;</span>hello<span class="tag">&lt;/h1&gt;</span>");
      };

      <span class="comment">
      //argumentì˜ ìœ„ì¹˜ ìˆœì„œë§Œ ì§€ì¼œì£¼ë©´ ì–´ë– í•œ ì´ë¦„ë„ ìƒê´€ ì—†ë‹¤.
      //request-object, response-object ìˆœì„œì´ë‹¤.
      </span>
      <span class="const">const</span> <span class="tag">handleHome</span> = (x, y) =&gt; {
        <span class="const">return</span> y.<span class="attribute">send</span>("<span class="tag">&lt;h1&gt;</span>hello<span class="tag">&lt;/h1&gt;</span>"); 
      };
    </pre>

    <h2>morgan</h2>

    <p>
      GET, path, status code , ì‘ë‹µì‹œê°„ ëª¨ë“  ì •ë³´ë¥¼ ê°€ì§€ê³ ìˆëŠ” middlewareì´ë‹¤.
    </p>

    <p>
      <span class="codeline">npm i morgan</span> ìœ¼ë¡œ ì„¤ì¹˜ ê°€ëŠ¥í•˜ê³ ,
      <span class="codeline"> import &lt;morgan&gt; from "morgan"; </span>`
      &lt;morgan&gt;ì€ ë³„ëª…ì´ê¸°ì— ë§ˆìŒëŒ€ë¡œ ì§€ì •í•´ë„ ëœë‹¤. &lt;morgan&gt;ì€
      ë³„ëª…ì´ê¸°ì— ë§ˆìŒëŒ€ë¡œ ì§€ì •í•´ë„ ëœë‹¤.
    </p>

    <pre class="codeBlock">
      <span class="const">import</span> <span class="tag">morgan</span> <span class="const">from</span> <span class="quot">"morgan"</span>; 
      
      <span class="comment">// ìƒëµ</span>

      <span class="const">const</span> <span class="tag">logger</span> = <span class="attribute">morgan</span>(<span class="quot">"dev"</span>); 
      
      app.<span class="attribute">use</span>(logger);
    </pre>

    <pre class="codeBlock">
      <span class="comment">// Method, Url, statusCode, ì‘ë‹µì‹œê°„</span>
      <span class="console">GET</span> / 304 2.339 ms - -
    </pre>
  </body>
</html>
