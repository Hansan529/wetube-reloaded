<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ROUTER</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <h1>#4.0 What are Routers?</h1>
    <p>ê¸°ë³¸ì ì¸ URL ê²½ë¡œì´ë‹¤.</p>
    <pre class="codeBlock">
      / â†’ home
      /join â†’ Join
      /login â†’ Login
      /search â†’ Search

      /user/edit â†’ Edit User
      /user/delete â†’ Delete User
      
      /video/watch â†’ Watch Video
      /video/edit â†’ Edit Video
      /video/delete â†’ Delete Video
      /video/comments â†’ Comment on a video
      /video/comments/delete â†’ Delete A
    </pre>
    <p>í•´ë‹¹ ì£¼ì œì— ëŒ€í•´ ë¼ìš°í„°ë¥¼ í†µí•´ ì •ë¦¬í•´ê² ë‹¤.</p>

    <p>ë¼ìš°í„°ëŠ” ì‘ì—…ì¤‘ì¸ ì£¼ì œë¥¼ ê¸°ë°˜ìœ¼ë¡œ URLì„ ê·¸ë£¹í™”í•œë‹¤.</p>

    <pre class="codeBlock">
      <span class="comment">// /edit-user â†’ Edit User</span>
      /users/edit â†’ Edit <meta name="uservoice" content="#" />

      <span class="comment">// /delete-user â†’ Delete User</span>
      /users/delete

      <span class="comment">// /watch-video â†’ What Video</span>
      /videos/watch

      <span class="comment">// /edit-video â†’ Edit Video</span>
      /videos/edit

      <span class="comment">// /delete-video â†’ Delete Video</span>
      /videos/delete
    </pre>
    <pre class="codeBlock">
      <span class="comment">/* ê¸€ë¡œë²Œ ë¼ìš°í„°(global router)</span>
      <span class="comment">í™ˆì—ì„œ ë°”ë¡œ ê°ˆ ìˆ˜ ìˆëŠ” í˜ì´ì§€ë“¤ì„ ë‹´ê³  ìˆë‹¤. */</span>
      / â†’ Home
      /join â†’ Join
      /login â†’ Login
      /search â†’ Search

      <span class="comment">/* ê¸°ì¡´ ê·œì¹™ëŒ€ë¡œ Routerë¥¼ ì‘ì„±í•´ë³¸ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì„ ê±°ë‹¤.</span>
      <span class="comment">userê°€ join, loginì„ í•˜ëŠ” ê²ƒì´ ëª…í™•í•˜ê³ , videoë¥¼ searchí•˜ëŠ” ê²ƒìœ¼ë¡œ ëª…í™•íˆ êµ¬ë¶„ ë˜ì–´ ìˆê¸° ë•Œë¬¸ì´ë‹¤. */</span>
      /users/join
      /users/login
      /videos/search

      <span class="comment">/* í•˜ì§€ë§Œ ê°„ëµí•˜ê²Œ í•˜ì—¬ ì ‘ê·¼ì´ ì‰½ë„ë¡ í•  ë•Œ ì˜ˆì™¸ë¡œ routerë¥¼ ë§Œë“¤ê¸°ë„ í•œë‹¤.</span>
      <span class="comment">ë‘ ì°¨ì´ë¥¼ ë³´ë©´ ì´í•´í•˜ê¸° ì‰½ë‹¤. */</span>
      http://hansan529.github.io/wetube-reloaded/join
      http://hansan529.github.io/wetube-reloaded/users/join 
    </pre>
    <p>ë¼ìš°í„°ì— ëŒ€í•´ ì•Œì•˜ìœ¼ë‹ˆ, ìƒì„±í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ì</p>
    <br />
    <pre class="codeBlock">
      <span class="comment">// ìƒì„±</span>
      <span class="const">const</span> <span class="tag">globalRouter</span> = express.<span class="attribute">Router</span>();
      <span class="const">const</span> <span class="tag">userRouter</span> = express.<span class="attribute">Router</span>();
      <span class="const">const</span> <span class="tag">videoRouter</span> = express.<span class="attribute">Router</span>();
      
      <span class="comment">// ì‚¬ìš©</span>
      app.<span class="attribute">use</span>(<span class="text">"/"</span>, globalRouter);
      app.<span class="attribute">use</span>(<span class="text">"/users"</span>, userRouter);
      app.<span class="attribute">use</span>(<span class="text">"/videos"</span>, videoRouter);
    </pre>
    <p>Routerë“¤ì˜ ì²« í˜ì´ì§€ë¥¼ ìƒì„±í•œë‹¤.</p>
    <pre class="codeBlock">
      <span class="const">const</span> <span class="tag">globalRouter</span> = express.<span class="console">Router</span>();
      <span class="const">const</span> <span class="attribute">handleHome</span> = (req, res) =&gt; res.<span class="attribute">send</span>(<span class="text">"home"</span>);
      globalRouter.<span class="attribute">get</span>(<span class="text">"/"</span>, handleHome)

      <span class="const">const</span> <span class="tag">userRouter</span> = express.<span class="console">Router</span>();
      <span class="const">const</span> <span class="attribute">handleEditUser</span> = (req, res) =&gt; res.<span class="attribute">send</span>(<span class="text">"Edit User"</span>);
      userRouter.<span class="attribute">get</span>(<span class="text">"/edit"</span>, handleEditUser)

      <span class="const">const</span> <span class="tag">videoRouter</span> = express.<span class="console">Router</span>();
      <span class="const">const</span> <span class="attribute">handleWatchVideo</span> = (req, res) =&gt; res.<span class="attribute">send</span>(<span class="text">"home"</span>);
      videoRouter.<span class="attribute">get</span>(<span class="text">"/watch"</span>, handleWatchVideo)
    </pre>
    <p>
      requestì—ì„œ "/videos"ë¡œ ì‹œì‘í•˜ëŠ” urlì„ ì°¾ëŠ”ë‹¤ë©´, ExpressëŠ” videoRouterë¥¼
      ì‹¤í–‰í•˜ì—¬, /watch ë£¨íŠ¸ë¥¼ ì´ìš©í•˜ê²Œ ëœë‹¤. <br />
      ê·¸ ë•ë¶„ì— <span class="codeline">/videos/watch</span> ë¼ê³  ì§€ì •ì„ í•˜ì§€
      ì•Šì•„ë„ ì´ë™ì´ ëœë‹¤.
    </p>
    <h1>#4.2 Cleaning the Code</h1>
    <p>ì‘ë™í•˜ëŠ” ì½”ë“œë¥¼ ì™„ì„±í–ˆì„ ë•Œ, ë„ˆì €ë¶„í•œ ì½”ë“œë¥¼ ì •ë¦¬í•´ì£¼ì–´ì•¼ í•œë‹¤.</p>
    <p>
      ìš°ì„  ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ë¼ìš°í„°ë¥¼ ë¶„ë¦¬í•´ì¤€ë‹¤. ëª¨ë“ˆê³¼ ê°™ì´ ë³„ë„ì˜ íŒŒì¼ì—ì„œë„
      ë…ë¦½ì ìœ¼ë¡œ ì‘ë™í•´ì•¼í•˜ê¸°ì—, ë¶„ë¦¬í•œ íŒŒì¼ì—ì„œë„ expressë¥¼ import í•´ì•¼ í•œë‹¤.
    </p>
    <pre class="codeBlock">
      <span class="comment">// ê¸°ì¡´ íŒŒì¼ êµ¬ì„± (í†µí•©)</span>
      <span class="const">src</span>/server.js

      <span class="comment">// ì´í›„ì˜ íŒŒì¼ êµ¬ì„± (ë¶„ë¦¬)</span>
      <span class="const">src</span>/<span class="attribute">routers</span>/globalRouter.js
      <span class="const">src</span>/<span class="attribute">routers</span>/userRouter.js
      <span class="const">src</span>/<span class="attribute">routers</span>/videoRouter.js
    </pre>
    <p>
      server.js ì—ì„œ routerë“¤ì„ ë¶ˆëŸ¬ì˜¤ê¸° ìœ„í•´ì„œëŠ” routerì—ì„œ exportë¥¼ ì§„í–‰í•´ì•¼
      í•œë‹¤. ê°œê°œì¸ì˜ ë…ë¦½ì ì¸ íŒŒì¼ì´ê¸°ì— ê³µê°œë˜ì–´ìˆì§€ ì•Šì•„ì„œ, ê°™ì€ ì´ë¦„ì„
      ì§€ì •í•˜ë”ë¼ë„ ì•„ë¬´ëŸ° ë¬¸ì œê°€ ì—†ë‹¤.
    </p>
    <p>
      ìš°ë¦¬ëŠ” íŒŒì¼ ìì²´ë¥¼ import í•  ê²ƒì´ ì•„ë‹Œ, ë³€ìˆ˜ë§Œ import í•˜ê³ ì í•˜ëŠ” ê²ƒì´ê¸°ì—
      ì½”ë“œë¥¼ ì‘ì„±í•´ì¤€ë‹¤.
    </p>
    <pre class="codeBlock">
      <span class="comment">// server.js</span>
      <span class="json">import</span> globalRouter <span class="json">from</span> ".<span class="text">/routers/globalRouter</span>";
      <span class="json">import</span> userRouter <span class="json">from</span> ".<span class="text">/routers/userRouter</span>";
      <span class="json">import</span> videoRouter <span class="json">from</span> ".<span class="text">/routers/videoRouter</span>";

      <span class="comment">// globalRouter.js</span>
      <span class="json">import</span> express <span class="json">from</span> "<span class="text">express</span>";
      
      <span class="const">const</span> <span class="tag">globalRouter</span> = express.<span class="console">Router</span>();
      
      <span class="const">const</span> <span class="attribute">handleHome</span> = (req, res) =&gt; res.send("home");
      
      globalRouter.<span class="attribute">get</span>("<span class="text">/</span>", handleHome);
      
      <span class="json">export</span> <span class="json">default</span> globalRouter;span
      
      <span class="comment">// userRouter.js</span>
      <span class="comment">// videoRouter.js</span>
    </pre>
    <p>
      server íŒŒì¼ì— ìˆë˜ ì½”ë“œë¥¼ ëª¨ë‘ ì˜®ê¸°ê³  Routerì—ì„œëŠ” Exportë¥¼ í•˜ë©°
      server.jsì—ì„œëŠ” ì´ë¥¼ import í•˜ì—¬ ì´ìš©í•œë‹¤. ì—¬ëŸ¬ê°œì˜ Routerë¥¼ ì¶”ê°€í•´ë„
      ë™ì¼í•˜ë‹¤.
    </p>
    <p>
      í—ˆë‚˜, í•˜ë‚˜ ë‘ê°œì˜ ì ì€ ê°œìˆ˜ë¼ë©´ ê´œì°®ê² ì§€ë§Œ, ë§ì•„ì§€ë©´ Router.js ì•ˆì—
      Controllerì™€ Router ë‘ ê°€ì§€ê°€ ëª¨ë‘ ë“¤ì–´ìˆê¸°ì— ì´ë¥¼ ë˜ ë¶„ë¦¬í•´ì¤€ë‹¤.
    </p>
    <pre class="codeBlock">
      <span class="comment">// src</span>
      <span class="attribute">controllers</span>/userController.js
      <span class="attribute">controllers</span>/videoController.js
    </pre>
    <p>
      globalControllerê°€ ì—†ëŠ” ì´ìœ ëŠ” urlì„ ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©í•˜ë ¤ê³  ë§Œë“  ê²ƒì´ê¸°ì—,
      ì‹¤ì œë¡œ ì´ìš©í•˜ëŠ” ê²ƒì€ userì™€ videoController ë²”ìœ„ì— ë“¤ì–´ê°„ë‹¤.
    </p>
    <pre class="codeBlock">
      <span class="comment">// userController</span>
      <span class="const">const</span> join = (req, res) =&gt; res.<span class="attribute">send</span>("<span class="text">Join</span>");
      <span class="json">export default</span> join;

      <span class="comment">// videoController</span>
      <span class="const">const</span> trending = (req, res) =&gt; res.<span class="attribute">send</span>("<span class="text">Home Page Videos</span>");
      <span class="json">export default</span> trending;

      <span class="comment">// globalRouter</span>
      <span class="json">import</span> express <span class="json">from</span> "<span class="text">express</span>";
      <span class="json">import</span> join <span class="json">from</span> "<span class="text">../controllers/userController</span>";
      <span class="json">import</span> trending <span class="json">from</span> "<span class="text">../controllers/videoController</span>";

      <span class="const">const</span> <span class="tag">globalRouter</span> = express.<span class="attribute">Router</span>();

      globalRouter.<span class="attribute">get</span>("/", trending);
      globalRouter.<span class="attribute">get</span>("/join", join);

      <span class="json">export default</span> globalRouter;
    </pre>
    <p>
      Routerë¥¼ serverì—ì„œ ë…ë¦½ì‹œí‚¬ ë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ ë³„ë„ì˜ jsì—ì„œ controller
      ë³€ìˆ˜ë¥¼ ì§€ì •í•˜ê³ , exportí•œ ë‹¤ìŒ routerì—ì„œ importí•˜ëŠ” ê²ƒì´ë‹¤.
    </p>
    <p>
      ë‹¤ë§Œ ë¬¸ì œì ì€ export defaultëŠ” í•˜ë‚˜ë°–ì— exportí•˜ì§€ ëª»í•œë‹¤. ê·¸ë˜ì„œ ì´ë¦„ì€
      ìƒê´€ ì—†ì´ ì§€ì •í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.
    </p>
    <pre class="codeBlock">
      <span class="comment">// globalRouter</span>
      <span class="json">import</span> express <span class="json">from</span> "<span class="text">express</span>";
      <span class="json">import</span> { join } <span class="json">from</span> "<span class="text">../controllers/userController</span>";
      <span class="json">import</span> { trending } <span class="json">from</span> "<span class="text">../controllers/videoController</span>";
      
      <span class="const">const</span> <span class="tag">globalRouter</span> = express.<span class="attribute">Router</span>();
      
      globalRouter.<span class="attribute">get</span>("<span class="text">/</span>", trending);
      globalRouter.<span class="attribute">get</span>("<span class="text">/join</span>", join);
      
      <span class="json">export default</span> globalRouter;
      
      
      <span class="comment">// videoController</span>
      <span class="json">export</span> <span class="const">const</span> trending = (req, res) =&gt; res.<span class="attribute">send</span>("<span class="text">Home Page Videos</span>");
      <span class="json">export</span> <span class="const">const</span> watch = (req, res) =&gt; res.<span class="attribute">send</span>("<span class="text">Watch</span>");
      <span class="json">export</span> <span class="const">const</span> edit = (req, res) =&gt; res.<span class="attribute">send</span>("<span class="text">Edit</span>");
    </pre>
    <p>
      í•˜ì§€ë§Œ exportë¥¼ ë³€ìˆ˜ ì•ì— ì§€ì •í•´ì¤„ ê²½ìš°, ì—¬ëŸ¬ê°œë¥¼ export í•  ìˆ˜ ìˆë‹¤.
      í•˜ì§€ë§Œ ì •í™•í•œ ì´ë¦„ì„ ì‘ì„±í•´ì£¼ì–´ì•¼ ì •ìƒì ìœ¼ë¡œ ê°’ì„ ë¶ˆëŸ¬ì˜¨ë‹¤.
    </p>
    <p>
      ë§Œì•½ì— ì—†ëŠ” routerë¥¼ ë¶ˆëŸ¬ì˜¬ ê²½ìš° ì´ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.
      <br />
      <span class="codeline"
        >Route.get() requires a callback function but got a [object
        Undefined]</span
      >
      ë¼ìš°í„°ì—ê²Œ ì¡´ì¬í•˜ì§€ ì•Šì€ í•¨ìˆ˜ë¥¼ ì§€ì •í–ˆë‹¤ëŠ” ë§ì´ë‹¤.
    </p>
    <br />
    <h2>ë³µìŠµ</h2>
    <pre class="codeBlock">
      <span class="comment">// í˜„ì¬ê¹Œì§€ì˜ ì½”ë“œ</span>

      <span class="comment">// server.js</span>
      <span class="json">import</span> express <span class="json">from</span> "<span class="text">express</span>";
      <span class="json">import</span> morgan <span class="json">from</span> "<span class="text">morgan</span>";
      <span class="json">import</span> globalRouter <span class="json">from</span> "<span class="text">./routers/globalRouter</span>";
      <span class="json">import</span> videoRouter <span class="json">from</span> "<span class="text">./routers/videoRouter</span>";
      <span class="json">import</span> userRouter <span class="json">from</span> "<span class="text">./routers/userRouter</span>";
      <span class="const">const</span> <span class="tag">PORT</span> = 4000;
      <span class="const">const</span> <span class="tag">app</span> = express();
      <span class="const">const</span> <span class="tag">logger</span> = morgan("<span class="text">dev</span>");
      app.<span class="attribute">use</span>(logger);
      app.<span class="attribute">use</span>("<span class="text">/</span>", globalRouter);
      app.<span class="attribute">use</span>("<span class="text">/users</span>", userRouter);
      app.<span class="attribute">use</span>("<span class="text">/videos</span>", videoRouter);
      <span class="const">const</span> <span class="tag">handleListening</span> = () =&gt; console.log(`<span class="text">Server listening on port http://localhost:${PORT} ğŸš€</span>`);
      app.<span class="attribute">listen</span>(PORT, <span class="attribute">handleListening</span>);

      <span class="comment">// globalRouter.js</span>
      <span class="json">import</span> express <span class="json">from</span> "<span class="text">express</span>";
      <span class="json">import</span> { join } <span class="json">from</span> "<span class="text">../controllers/userController</span>";
      <span class="json">import</span> { trending } <span class="json">from</span> "<span class="text">../controllers/videoController</span>";
      <span class="const">const</span> globalRouter = express.<span class="attribute">Router</span>();
      globalRouter.<span class="attribute">get</span>("<span class="text">/</span>", trending);
      globalRouter.<span class="attribute">get</span>("<span class="text">/join</span>", join);
      <span class="json">export default</span> globalRouter;

      <span class="comment">// videoRouter.js</span>
      <span class="json">import</span> express <span class="json">from</span> "<span class="text">express</span>";
      <span class="json">import</span> { watch } <span class="json">from</span> "<span class="text">../controllers/videoController</span>";
      <span class="json">import</span> { edit } <span class="json">from</span> "<span class="text">../controllers/videoController</span>";
      <span class="const">const</span> videoRouter = express.<span class="attribute">Router</span>();
      videoRouter.<span class="attribute">get</span>("<span class="text">/watch</span>", watch);
      videoRouter.<span class="attribute">get</span>("<span class="text">/edit</span>", edit);
      <span class="json">export default</span> videoRouter;

      <span class="comment">// userRouter.js</span>
      <span class="json">import</span> express <span class="json">from</span> "<span class="text">express</span>";
      <span class="json">import</span> { edit, remove } <span class="json">from</span> "<span class="text">../controllers/userController</span>";
      <span class="const">const</span> userRouter = express.<span class="attribute">Router</span>();
      userRouter.<span class="attribute">get</span>("<span class="text">/edit</span>", edit);
      userRouter.<span class="attribute">get</span>("<span class="text">/delete</span>", remove);
      <span class="json">export default</span> userRouter;

      <span class="comment">// userController.js</span>
      <span class="json">export</span> <span class="const">const</span> join = (req, res) =&gt; res.<span class="attribute">send</span>("<span class="text">Join</span>");
      <span class="json">export</span> <span class="const">const</span> edit = (req, res) =&gt; res.<span class="attribute">send</span>("<span class="text">Edit User</span>");
      <span class="json">export</span> <span class="const">const</span> removed = (req, res) =&gt; res.<span class="attribute">send</span>("<span class="text">Remove User</span>");


      <span class="comment">// videoController.js</span>
      <span class="json">export</span> <span class="const">const</span> trending = (req, res) =&gt; res.<span class="attribute">send</span>("<span class="text">Home Page Videos</span>");
      <span class="json">export</span> <span class="const">const</span> watch = (req, res) =&gt; res.<span class="attribute">send</span>("<span class="text">Watch</span>");
      <span class="json">export</span> <span class="const">const</span> edit = (req, res) =&gt; res.<span class="attribute">send</span>("<span class="text">Eidt</span>");
    </pre>
    <p>ë¼ìš°í„°ëŠ” urlì´ ì–´ë–»ê²Œ ì‹œì‘í•˜ëŠ”ì§€ì— ë”°ë¼ ë‚˜ëˆ„ëŠ” ë°©ë²•ì´ë‹¤.</p>
    <pre class="codeBlock">
      <span class="comment">// export default</span>
      import abc from "default" <span class="comment">// import abc = "default" ì´ë¦„ì€ abc ì´ì§€ë§Œ ê¸°ëŠ¥ì€ "default" í•¨ìˆ˜ì´ë‹¤.</span>

      <span class="comment">// export</span>
      import { function-name } from "../" <span class="comment">// objectë¥¼ ì—´ê³  ê·¸ ì•ˆì— export í•œ ìƒìˆ˜ ì´ë¦„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</span>
      <span class="comment">// ì¶”ê°€ë¡œ, from ì´í›„ ""ì— ë‹¨ì–´ë§Œ ìˆì„ ê²½ìš° expressëŠ” node_modulesì—ì„œ ì°¾ì•„ë³´ê³ , ../ì™€ ê°™ì€ ì ˆëŒ€, ìƒëŒ€ì£¼ì†Œë¥¼ ì´ìš©í•˜ë©´ ê²½ë¡œë¡œ ì¸ì‹í•œë‹¤.</span>
    </pre>
    <h1>#4.6 Planning Routes</h1>
    <pre class="codeBlock">
      / â†’ home
      /join â†’ Join
      /login â†’ Login
      /search â†’ Search

      /user/:id â†’ See User
      /user/logout â†’ Log Out
      <span class="comment">// í˜„ì¬ ë¡œê·¸ì¸ ì¤‘ì¸ ìœ ì €ë§Œ ê°€ëŠ¥í•¨</span>
      /user/edit â†’ Edit My Profile
      /user/delete â†’ Delete My Profile
      
      <span class="comment">// ëˆ„êµ¬ë‚˜ ë™ì˜ìƒì„ ë³¼ ìˆ˜ ìˆìŒ</span>
      /video/:id â†’ See Video
      <span class="comment">// ì‘ì„±ìë§Œ ê°€ëŠ¥í•¨</span>
      /video/:id/edit â†’ Edit Video
      /video/:id/delete â†’ Delete Video
      <span class="comment">// ë¡œê·¸ì¸ ì‹œ ëˆ„êµ¬ë‚˜ ì—…ë¡œë“œ í•  ìˆ˜ ìˆìŒ</span>
      /video/upload â†’ Upload Video
    </pre>
    <pre class="codeBlock">
      <span class="comment">// globalRouter</span>
      login, search Router ìƒì„±,
      login, search import
      
      <span class="comment">// userRouter</span>
      logout, see Router ìƒì„±
      logout, see import
      <span class="comment">// userController</span>
      login, logout, see Controller ìƒì„±
      login, logout, see import

      <span class="comment">// videoRouter</span>
       upload, delete ìƒì„± watch -&gt; see ë³€ê²½
      <span class="comment">// videoController</span>
       search, upload, deleteVideo Controller ìƒì„± watch -&gt; see ë³€ê²½
    </pre>
  </body>
</html>
